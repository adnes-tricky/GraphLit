(function(j,N){typeof exports=="object"&&typeof module!="undefined"?N(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],N):(j=typeof globalThis!="undefined"?globalThis:j||self,N(j["v-network-graph"]={},j.Vue))})(this,function(j,N){"use strict";var tn=Object.defineProperty,nn=Object.defineProperties;var en=Object.getOwnPropertyDescriptors;var gt=Object.getOwnPropertySymbols;var rn=Object.prototype.hasOwnProperty,on=Object.prototype.propertyIsEnumerable;var yt=(j,N,O)=>N in j?tn(j,N,{enumerable:!0,configurable:!0,writable:!0,value:O}):j[N]=O,Y=(j,N)=>{for(var O in N||(N={}))rn.call(N,O)&&yt(j,O,N[O]);if(gt)for(var O of gt(N))on.call(N,O)&&yt(j,O,N[O]);return j},vt=(j,N)=>nn(j,en(N));function O(t,n){var e,r=1;t==null&&(t=0),n==null&&(n=0);function i(){var o,l=e.length,f,h=0,a=0;for(o=0;o<l;++o)f=e[o],h+=f.x,a+=f.y;for(h=(h/l-t)*r,a=(a/l-n)*r,o=0;o<l;++o)f=e[o],f.x-=h,f.y-=a}return i.initialize=function(o){e=o},i.x=function(o){return arguments.length?(t=+o,i):t},i.y=function(o){return arguments.length?(n=+o,i):n},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function xt(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return U(this.cover(n,e),n,e,t)}function U(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o=t._root,l={data:r},f=t._x0,h=t._y0,a=t._x1,v=t._y1,w,p,y,d,s,u,c,g;if(!o)return t._root=l,t;for(;o.length;)if((s=n>=(w=(f+a)/2))?f=w:a=w,(u=e>=(p=(h+v)/2))?h=p:v=p,i=o,!(o=o[c=u<<1|s]))return i[c]=l,t;if(y=+t._x.call(null,o.data),d=+t._y.call(null,o.data),n===y&&e===d)return l.next=o,i?i[c]=l:t._root=l,t;do i=i?i[c]=new Array(4):t._root=new Array(4),(s=n>=(w=(f+a)/2))?f=w:a=w,(u=e>=(p=(h+v)/2))?h=p:v=p;while((c=u<<1|s)===(g=(d>=p)<<1|y>=w));return i[g]=o,i[c]=l,t}function pt(t){var n,e,r=t.length,i,o,l=new Array(r),f=new Array(r),h=1/0,a=1/0,v=-1/0,w=-1/0;for(e=0;e<r;++e)isNaN(i=+this._x.call(null,n=t[e]))||isNaN(o=+this._y.call(null,n))||(l[e]=i,f[e]=o,i<h&&(h=i),i>v&&(v=i),o<a&&(a=o),o>w&&(w=o));if(h>v||a>w)return this;for(this.cover(h,a).cover(v,w),e=0;e<r;++e)U(this,l[e],f[e],t[e]);return this}function dt(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{for(var l=i-e||1,f=this._root,h,a;e>t||t>=i||r>n||n>=o;)switch(a=(n<r)<<1|t<e,h=new Array(4),h[a]=f,f=h,l*=2,a){case 0:i=e+l,o=r+l;break;case 1:e=i-l,o=r+l;break;case 2:i=e+l,r=o-l;break;case 3:e=i-l,r=o-l;break}this._root&&this._root.length&&(this._root=f)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this}function wt(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function _t(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function z(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function mt(t,n,e){var r,i=this._x0,o=this._y0,l,f,h,a,v=this._x1,w=this._y1,p=[],y=this._root,d,s;for(y&&p.push(new z(y,i,o,v,w)),e==null?e=1/0:(i=t-e,o=n-e,v=t+e,w=n+e,e*=e);d=p.pop();)if(!(!(y=d.node)||(l=d.x0)>v||(f=d.y0)>w||(h=d.x1)<i||(a=d.y1)<o))if(y.length){var u=(l+h)/2,c=(f+a)/2;p.push(new z(y[3],u,c,h,a),new z(y[2],l,c,u,a),new z(y[1],u,f,h,c),new z(y[0],l,f,u,c)),(s=(n>=c)<<1|t>=u)&&(d=p[p.length-1],p[p.length-1]=p[p.length-1-s],p[p.length-1-s]=d)}else{var g=t-+this._x.call(null,y.data),_=n-+this._y.call(null,y.data),x=g*g+_*_;if(x<e){var m=Math.sqrt(e=x);i=t-m,o=n-m,v=t+m,w=n+m,r=y.data}}return r}function Nt(t){if(isNaN(v=+this._x.call(null,t))||isNaN(w=+this._y.call(null,t)))return this;var n,e=this._root,r,i,o,l=this._x0,f=this._y0,h=this._x1,a=this._y1,v,w,p,y,d,s,u,c;if(!e)return this;if(e.length)for(;;){if((d=v>=(p=(l+h)/2))?l=p:h=p,(s=w>=(y=(f+a)/2))?f=y:a=y,n=e,!(e=e[u=s<<1|d]))return this;if(!e.length)break;(n[u+1&3]||n[u+2&3]||n[u+3&3])&&(r=n,c=u)}for(;e.data!==t;)if(i=e,!(e=e.next))return this;return(o=e.next)&&delete e.next,i?(o?i.next=o:delete i.next,this):n?(o?n[u]=o:delete n[u],(e=n[0]||n[1]||n[2]||n[3])&&e===(n[3]||n[2]||n[1]||n[0])&&!e.length&&(r?r[c]=e:this._root=e),this):(this._root=o,this)}function At(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this}function Mt(){return this._root}function bt(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function jt(t){var n=[],e,r=this._root,i,o,l,f,h;for(r&&n.push(new z(r,this._x0,this._y0,this._x1,this._y1));e=n.pop();)if(!t(r=e.node,o=e.x0,l=e.y0,f=e.x1,h=e.y1)&&r.length){var a=(o+f)/2,v=(l+h)/2;(i=r[3])&&n.push(new z(i,a,v,f,h)),(i=r[2])&&n.push(new z(i,o,v,a,h)),(i=r[1])&&n.push(new z(i,a,l,f,v)),(i=r[0])&&n.push(new z(i,o,l,a,v))}return this}function zt(t){var n=[],e=[],r;for(this._root&&n.push(new z(this._root,this._x0,this._y0,this._x1,this._y1));r=n.pop();){var i=r.node;if(i.length){var o,l=r.x0,f=r.y0,h=r.x1,a=r.y1,v=(l+h)/2,w=(f+a)/2;(o=i[0])&&n.push(new z(o,l,f,v,w)),(o=i[1])&&n.push(new z(o,v,f,h,w)),(o=i[2])&&n.push(new z(o,l,w,v,a)),(o=i[3])&&n.push(new z(o,v,w,h,a))}e.push(r)}for(;r=e.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Et(t){return t[0]}function Lt(t){return arguments.length?(this._x=t,this):this._x}function Ot(t){return t[1]}function Dt(t){return arguments.length?(this._y=t,this):this._y}function H(t,n,e){var r=new Z(n==null?Et:n,e==null?Ot:e,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function Z(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function q(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var E=H.prototype=Z.prototype;E.copy=function(){var t=new Z(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,e,r;if(!n)return t;if(!n.length)return t._root=q(n),t;for(e=[{source:n,target:t._root=new Array(4)}];n=e.pop();)for(var i=0;i<4;++i)(r=n.source[i])&&(r.length?e.push({source:r,target:n.target[i]=new Array(4)}):n.target[i]=q(r));return t},E.add=xt,E.addAll=pt,E.cover=dt,E.data=wt,E.extent=_t,E.find=mt,E.remove=Nt,E.removeAll=At,E.root=Mt,E.size=bt,E.visit=jt,E.visitAfter=zt,E.x=Lt,E.y=Dt;function A(t){return function(){return t}}function T(t){return(t()-.5)*1e-6}function It(t){return t.x+t.vx}function St(t){return t.y+t.vy}function tt(t){var n,e,r,i=1,o=1;typeof t!="function"&&(t=A(t==null?1:+t));function l(){for(var a,v=n.length,w,p,y,d,s,u,c=0;c<o;++c)for(w=H(n,It,St).visitAfter(f),a=0;a<v;++a)p=n[a],s=e[p.index],u=s*s,y=p.x+p.vx,d=p.y+p.vy,w.visit(g);function g(_,x,m,L,D){var M=_.data,I=_.r,b=s+I;if(M){if(M.index>p.index){var k=y-M.x-M.vx,P=d-M.y-M.vy,S=k*k+P*P;S<b*b&&(k===0&&(k=T(r),S+=k*k),P===0&&(P=T(r),S+=P*P),S=(b-(S=Math.sqrt(S)))/S*i,p.vx+=(k*=S)*(b=(I*=I)/(u+I)),p.vy+=(P*=S)*b,M.vx-=k*(b=1-b),M.vy-=P*b)}return}return x>y+b||L<y-b||m>d+b||D<d-b}}function f(a){if(a.data)return a.r=e[a.data.index];for(var v=a.r=0;v<4;++v)a[v]&&a[v].r>a.r&&(a.r=a[v].r)}function h(){if(n){var a,v=n.length,w;for(e=new Array(v),a=0;a<v;++a)w=n[a],e[w.index]=+t(w,a,n)}}return l.initialize=function(a,v){n=a,r=v,h()},l.iterations=function(a){return arguments.length?(o=+a,l):o},l.strength=function(a){return arguments.length?(i=+a,l):i},l.radius=function(a){return arguments.length?(t=typeof a=="function"?a:A(+a),h(),l):t},l}function Tt(t){return t.index}function nt(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function et(t){var n=Tt,e=w,r,i=A(30),o,l,f,h,a,v=1;t==null&&(t=[]);function w(u){return 1/Math.min(f[u.source.index],f[u.target.index])}function p(u){for(var c=0,g=t.length;c<v;++c)for(var _=0,x,m,L,D,M,I,b;_<g;++_)x=t[_],m=x.source,L=x.target,D=L.x+L.vx-m.x-m.vx||T(a),M=L.y+L.vy-m.y-m.vy||T(a),I=Math.sqrt(D*D+M*M),I=(I-o[_])/I*u*r[_],D*=I,M*=I,L.vx-=D*(b=h[_]),L.vy-=M*b,m.vx+=D*(b=1-b),m.vy+=M*b}function y(){if(l){var u,c=l.length,g=t.length,_=new Map(l.map((m,L)=>[n(m,L,l),m])),x;for(u=0,f=new Array(c);u<g;++u)x=t[u],x.index=u,typeof x.source!="object"&&(x.source=nt(_,x.source)),typeof x.target!="object"&&(x.target=nt(_,x.target)),f[x.source.index]=(f[x.source.index]||0)+1,f[x.target.index]=(f[x.target.index]||0)+1;for(u=0,h=new Array(g);u<g;++u)x=t[u],h[u]=f[x.source.index]/(f[x.source.index]+f[x.target.index]);r=new Array(g),d(),o=new Array(g),s()}}function d(){if(l)for(var u=0,c=t.length;u<c;++u)r[u]=+e(t[u],u,t)}function s(){if(l)for(var u=0,c=t.length;u<c;++u)o[u]=+i(t[u],u,t)}return p.initialize=function(u,c){l=u,a=c,y()},p.links=function(u){return arguments.length?(t=u,y(),p):t},p.id=function(u){return arguments.length?(n=u,p):n},p.iterations=function(u){return arguments.length?(v=+u,p):v},p.strength=function(u){return arguments.length?(e=typeof u=="function"?u:A(+u),d(),p):e},p.distance=function(u){return arguments.length?(i=typeof u=="function"?u:A(+u),s(),p):i},p}var kt={value:()=>{}};function rt(){for(var t=0,n=arguments.length,e={},r;t<n;++t){if(!(r=arguments[t]+"")||r in e||/[\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new Q(e)}function Q(t){this._=t}function Pt(t,n){return t.trim().split(/^|\s+/).map(function(e){var r="",i=e.indexOf(".");if(i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}Q.prototype=rt.prototype={constructor:Q,on:function(t,n){var e=this._,r=Pt(t+"",e),i,o=-1,l=r.length;if(arguments.length<2){for(;++o<l;)if((i=(t=r[o]).type)&&(i=Ft(e[i],t.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<l;)if(i=(t=r[o]).type)e[i]=it(e[i],t.name,n);else if(n==null)for(i in e)e[i]=it(e[i],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new Q(t)},call:function(t,n){if((i=arguments.length-2)>0)for(var e=new Array(i),r=0,i,o;r<i;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};function Ft(t,n){for(var e=0,r=t.length,i;e<r;++e)if((i=t[e]).name===n)return i.value}function it(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=kt,t=t.slice(0,r).concat(t.slice(r+1));break}return e!=null&&t.push({name:n,value:e}),t}var $=0,B=0,C=0,ot=1e3,V,R,W=0,F=0,X=0,K=typeof performance=="object"&&performance.now?performance:Date,ft=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function at(){return F||(ft($t),F=K.now()+X)}function $t(){F=0}function G(){this._call=this._time=this._next=null}G.prototype=ut.prototype={constructor:G,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?at():+e)+(n==null?0:+n),!this._next&&R!==this&&(R?R._next=this:V=this,R=this),this._call=t,this._time=e,J()},stop:function(){this._call&&(this._call=null,this._time=1/0,J())}};function ut(t,n,e){var r=new G;return r.restart(t,n,e),r}function Bt(){at(),++$;for(var t=V,n;t;)(n=F-t._time)>=0&&t._call.call(void 0,n),t=t._next;--$}function st(){F=(W=K.now())+X,$=B=0;try{Bt()}finally{$=0,Rt(),F=0}}function Ct(){var t=K.now(),n=t-W;n>ot&&(X-=n,W=t)}function Rt(){for(var t,n=V,e,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:V=e);R=t,J(r)}function J(t){if(!$){B&&(B=clearTimeout(B));var n=t-F;n>24?(t<1/0&&(B=setTimeout(st,t-K.now()-X)),C&&(C=clearInterval(C))):(C||(W=K.now(),C=setInterval(Ct,ot)),$=1,ft(st))}}const Kt=1664525,Qt=1013904223,lt=4294967296;function Vt(){let t=1;return()=>(t=(Kt*t+Qt)%lt)/lt}function Wt(t){return t.x}function Xt(t){return t.y}var Yt=10,Ht=Math.PI*(3-Math.sqrt(5));function ct(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),o=0,l=.6,f=new Map,h=ut(w),a=rt("tick","end"),v=Vt();t==null&&(t=[]);function w(){p(),a.call("tick",n),e<r&&(h.stop(),a.call("end",n))}function p(s){var u,c=t.length,g;s===void 0&&(s=1);for(var _=0;_<s;++_)for(e+=(o-e)*i,f.forEach(function(x){x(e)}),u=0;u<c;++u)g=t[u],g.fx==null?g.x+=g.vx*=l:(g.x=g.fx,g.vx=0),g.fy==null?g.y+=g.vy*=l:(g.y=g.fy,g.vy=0);return n}function y(){for(var s=0,u=t.length,c;s<u;++s){if(c=t[s],c.index=s,c.fx!=null&&(c.x=c.fx),c.fy!=null&&(c.y=c.fy),isNaN(c.x)||isNaN(c.y)){var g=Yt*Math.sqrt(.5+s),_=s*Ht;c.x=g*Math.cos(_),c.y=g*Math.sin(_)}(isNaN(c.vx)||isNaN(c.vy))&&(c.vx=c.vy=0)}}function d(s){return s.initialize&&s.initialize(t,v),s}return y(),n={tick:p,restart:function(){return h.restart(w),n},stop:function(){return h.stop(),n},nodes:function(s){return arguments.length?(t=s,y(),f.forEach(d),n):t},alpha:function(s){return arguments.length?(e=+s,n):e},alphaMin:function(s){return arguments.length?(r=+s,n):r},alphaDecay:function(s){return arguments.length?(i=+s,n):+i},alphaTarget:function(s){return arguments.length?(o=+s,n):o},velocityDecay:function(s){return arguments.length?(l=1-s,n):1-l},randomSource:function(s){return arguments.length?(v=s,f.forEach(d),n):v},force:function(s,u){return arguments.length>1?(u==null?f.delete(s):f.set(s,d(u)),n):f.get(s)},find:function(s,u,c){var g=0,_=t.length,x,m,L,D,M;for(c==null?c=1/0:c*=c,g=0;g<_;++g)D=t[g],x=s-D.x,m=u-D.y,L=x*x+m*m,L<c&&(M=D,c=L);return M},on:function(s,u){return arguments.length>1?(a.on(s,u),n):a.on(s)}}}function ht(){var t,n,e,r,i=A(-30),o,l=1,f=1/0,h=.81;function a(y){var d,s=t.length,u=H(t,Wt,Xt).visitAfter(w);for(r=y,d=0;d<s;++d)n=t[d],u.visit(p)}function v(){if(t){var y,d=t.length,s;for(o=new Array(d),y=0;y<d;++y)s=t[y],o[s.index]=+i(s,y,t)}}function w(y){var d=0,s,u,c=0,g,_,x;if(y.length){for(g=_=x=0;x<4;++x)(s=y[x])&&(u=Math.abs(s.value))&&(d+=s.value,c+=u,g+=u*s.x,_+=u*s.y);y.x=g/c,y.y=_/c}else{s=y,s.x=s.data.x,s.y=s.data.y;do d+=o[s.data.index];while(s=s.next)}y.value=d}function p(y,d,s,u){if(!y.value)return!0;var c=y.x-n.x,g=y.y-n.y,_=u-d,x=c*c+g*g;if(_*_/h<x)return x<f&&(c===0&&(c=T(e),x+=c*c),g===0&&(g=T(e),x+=g*g),x<l&&(x=Math.sqrt(l*x)),n.vx+=c*y.value*r/x,n.vy+=g*y.value*r/x),!0;if(y.length||x>=f)return;(y.data!==n||y.next)&&(c===0&&(c=T(e),x+=c*c),g===0&&(g=T(e),x+=g*g),x<l&&(x=Math.sqrt(l*x)));do y.data!==n&&(_=o[y.data.index]*r/x,n.vx+=c*_,n.vy+=g*_);while(y=y.next)}return a.initialize=function(y,d){t=y,e=d,v()},a.strength=function(y){return arguments.length?(i=typeof y=="function"?y:A(+y),v(),a):i},a.distanceMin=function(y){return arguments.length?(l=y*y,a):Math.sqrt(l)},a.distanceMax=function(y){return arguments.length?(f=y*y,a):Math.sqrt(f)},a.theta=function(y){return arguments.length?(h=y*y,a):Math.sqrt(h)},a}function Zt(t,n,e){var r,i=A(.1),o,l;typeof t!="function"&&(t=A(+t)),n==null&&(n=0),e==null&&(e=0);function f(a){for(var v=0,w=r.length;v<w;++v){var p=r[v],y=p.x-n||1e-6,d=p.y-e||1e-6,s=Math.sqrt(y*y+d*d),u=(l[v]-s)*o[v]*a/s;p.vx+=y*u,p.vy+=d*u}}function h(){if(r){var a,v=r.length;for(o=new Array(v),l=new Array(v),a=0;a<v;++a)l[a]=+t(r[a],a,r),o[a]=isNaN(l[a])?0:+i(r[a],a,r)}}return f.initialize=function(a){r=a,h()},f.strength=function(a){return arguments.length?(i=typeof a=="function"?a:A(+a),h(),f):i},f.radius=function(a){return arguments.length?(t=typeof a=="function"?a:A(+a),h(),f):t},f.x=function(a){return arguments.length?(n=+a,f):n},f.y=function(a){return arguments.length?(e=+a,f):e},f}function Gt(t){var n=A(.1),e,r,i;typeof t!="function"&&(t=A(t==null?0:+t));function o(f){for(var h=0,a=e.length,v;h<a;++h)v=e[h],v.vx+=(i[h]-v.x)*r[h]*f}function l(){if(e){var f,h=e.length;for(r=new Array(h),i=new Array(h),f=0;f<h;++f)r[f]=isNaN(i[f]=+t(e[f],f,e))?0:+n(e[f],f,e)}}return o.initialize=function(f){e=f,l()},o.strength=function(f){return arguments.length?(n=typeof f=="function"?f:A(+f),l(),o):n},o.x=function(f){return arguments.length?(t=typeof f=="function"?f:A(+f),l(),o):t},o}function Jt(t){var n=A(.1),e,r,i;typeof t!="function"&&(t=A(t==null?0:+t));function o(f){for(var h=0,a=e.length,v;h<a;++h)v=e[h],v.vy+=(i[h]-v.y)*r[h]*f}function l(){if(e){var f,h=e.length;for(r=new Array(h),i=new Array(h),f=0;f<h;++f)r[f]=isNaN(i[f]=+t(e[f],f,e))?0:+n(e[f],f,e)}}return o.initialize=function(f){e=f,l()},o.strength=function(f){return arguments.length?(n=typeof f=="function"?f:A(+f),l(),o):n},o.y=function(f){return arguments.length?(t=typeof f=="function"?f:A(+f),l(),o):t},o}const Ut=Object.freeze(Object.defineProperty({__proto__:null,forceCenter:O,forceCollide:tt,forceLink:et,forceManyBody:ht,forceRadial:Zt,forceSimulation:ct,forceX:Gt,forceY:Jt},Symbol.toStringTag,{value:"Module"}));class qt{constructor(n={}){this.options=n}activate(n){const{nodePositions:e,nodes:r,edges:i,emitter:o,svgPanZoom:l}=n;let{nodeLayouts:f,nodeLayoutMap:h}=this.buildNodeLayouts(r.value,e,{x:0,y:0});const a=this.createSimulation(f,this.forceLayoutEdges(i.value,r.value));a.on("tick",()=>{var s,u,c;for(const g of f){const _=(s=e.value)==null?void 0:s[g.id];_&&(_.x=(u=g.x)!=null?u:0,_.y=(c=g.y)!=null?c:0)}});const v=()=>{a.alpha(.1).restart()},w=s=>{for(const[u,c]of Object.entries(s)){const g=h[u];g.fx=c.x,g.fy=c.y}v()},p=s=>{var u;for(const[c,g]of Object.entries(s)){const _=this.getNodeLayout(e,c),x=(u=h==null?void 0:h[c])!=null?u:{x:0,y:0};_.value.fixed||this.options.positionFixedByDrag?(x.fx=g.x,x.fy=g.y,_.value.fixed=!0):(x.x=g.x,x.y=g.y,delete x.fx,delete x.fy)}v()},y=({node:s,event:u})=>{if(this.options.positionFixedByClickWithAltKey&&u.altKey){const c=this.getNodeLayout(e,s);let g=h==null?void 0:h[s];g||(g={id:s,x:0,y:0},h[s]=g),c.value.fixed?(delete c.value.fixed,g.x=g.fx||g.x,g.y=g.fy||g.y,delete g.fx,delete g.fy):(c.value.fixed=!0,g.fx=g.x,g.fy=g.y),v()}},d=N.watch(()=>[Object.keys(r.value),Object.values(i.value).map(s=>`${s.source}=${s.target}`)],()=>{const s=l.getViewArea();({nodeLayouts:f,nodeLayoutMap:h}=this.buildNodeLayouts(r.value,e,s.center)),a.nodes(f);const u=a.force("edge");u&&u.links(this.forceLayoutEdges(i.value,r.value)),v()});o.on("node:dragstart",w),o.on("node:pointermove",w),o.on("node:dragend",p),o.on("node:click",y),this.onDeactivate=()=>{a.stop(),d(),o.off("node:dragstart",w),o.off("node:pointermove",w),o.off("node:dragend",p),o.off("node:click",y)}}deactivate(){this.onDeactivate&&this.onDeactivate()}createSimulation(n,e){if(this.options.createSimulation)return this.options.createSimulation(Ut,n,e);{const r=et(e).id(i=>i.id);return ct(n).force("edge",r.distance(100)).force("charge",ht()).force("collide",tt(50).strength(.2)).force("center",O().strength(.05)).alphaMin(.001)}}buildNodeLayouts(n,e,r){const i=Object.keys(n).filter(f=>!(f in e.value));for(const f of i)e.value[f]=Y({},r);const o=this.forceNodeLayouts(e.value),l=Object.fromEntries(o.map(f=>[f.id,f]));return{nodeLayouts:o,nodeLayoutMap:l}}forceNodeLayouts(n){return Object.entries(n).map(([e,r])=>r.fixed?vt(Y({id:e},r),{fx:r.x,fy:r.y}):Y({id:e},r))}forceLayoutEdges(n,e){return Object.values(n).filter(r=>r.source in e&&r.target in e).map(r=>({source:r.source,target:r.target}))}getNodeLayout(n,e){const r=N.toRef(n.value,e);return r.value||(r.value={x:0,y:0}),r}}j.ForceLayout=qt,Object.defineProperty(j,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=force-layout.js.map
